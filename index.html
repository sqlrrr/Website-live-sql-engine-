<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Autonomous AI | Crypto Intelligence</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* ================= CSS (STYLING) ================= */
        :root {
            --bg-dark: #0b0e11;
            --bg-card: #1e2329;
            --text-main: #eaecef;
            --text-sub: #848e9c;
            --green: #0ecb81;
            --red: #f6465d;
            --gold: #f0b90b;
            --blue: #3b82f6;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Roboto, Helvetica, sans-serif; }
        
        body { background-color: var(--bg-dark); color: var(--text-main); padding: 20px; }

        /* Header */
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #2b3139; padding-bottom: 15px; }
        .logo { font-size: 24px; font-weight: bold; color: var(--gold); }
        .status { font-size: 14px; color: var(--green); display: flex; align-items: center; gap: 5px; }
        .blink { width: 10px; height: 10px; background-color: var(--green); border-radius: 50%; animation: pulse 1.5s infinite; }

        /* Grid Layout */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            gap: 20px;
            height: calc(100vh - 100px);
        }

        /* Common Card Style */
        .card { background-color: var(--bg-card); border-radius: 8px; padding: 15px; overflow: hidden; display: flex; flex-direction: column; }
        .card-header { font-size: 16px; font-weight: 600; margin-bottom: 15px; color: var(--text-sub); border-bottom: 1px solid #2b3139; padding-bottom: 5px; }

        /* Sidebar (Market Prices) */
        .market-list .item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #2b3139; }
        .price-up { color: var(--green); }
        .price-down { color: var(--red); }

        /* Main Center (Signal & Charts) */
        .main-panel { display: flex; flex-direction: column; gap: 20px; }
        
        .signal-box { 
            background: linear-gradient(135deg, #1e2329 0%, #2b3139 100%); 
            padding: 20px; border-radius: 8px; border: 1px solid var(--blue); text-align: center;
        }
        .signal-title { color: var(--text-sub); font-size: 14px; letter-spacing: 1px; }
        .signal-value { font-size: 48px; font-weight: bold; margin: 10px 0; }
        .signal-confidence { font-size: 14px; background: rgba(59, 130, 246, 0.2); padding: 5px 10px; border-radius: 4px; color: var(--blue); display: inline-block; }

        /* Right Panel (Logs & Sentiment) */
        .logs-container { flex-grow: 1; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 12px; color: var(--text-sub); }
        .log-entry { margin-bottom: 5px; }
        .log-time { color: var(--gold); margin-right: 5px; }
        
        .whale-alert { color: var(--gold); font-weight: bold; }
        .news-alert { color: var(--blue); }

        /* Animations */
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

        /* Responsive */
        @media (max-width: 1024px) {
            .dashboard-grid { grid-template-columns: 1fr; height: auto; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo"><i class="fas fa-brain"></i> SQL AUTONOMOUS AI</div>
        <div class="status">
            <div class="blink"></div> SYSTEM ONLINE ‚Ä¢ LINKED TO FIREBASE
        </div>
    </header>

    <div class="dashboard-grid">
        
        <div class="card">
            <div class="card-header"><i class="fas fa-chart-line"></i> LIVE MARKET</div>
            <div class="market-list" id="market-list">
                <div class="item"><span>Loading...</span></div>
            </div>
            
            <div class="card-header" style="margin-top: 20px;"><i class="fas fa-gas-pump"></i> ON-CHAIN GAS</div>
            <div style="display:flex; justify-content:space-between; margin-top:10px;">
                <div style="text-align:center;">
                    <div style="font-size:12px; color:var(--text-sub);">ETH</div>
                    <div id="eth-gas" style="font-weight:bold;">15 Gwei</div>
                </div>
                <div style="text-align:center;">
                    <div style="font-size:12px; color:var(--text-sub);">SOL</div>
                    <div style="font-weight:bold;">0.0005 SOL</div>
                </div>
            </div>
        </div>

        <div class="main-panel">
            <div class="signal-box" id="signal-box">
                <div class="signal-title">AI GLOBAL CONSENSUS</div>
                <div class="signal-value" id="final-signal">ANALYZING...</div>
                <div class="signal-confidence" id="signal-conf">Confidence: 0%</div>
                <p style="margin-top:10px; font-size:12px; color:var(--text-sub);">
                    Based on: Orderbook, Sentiment, Whale Movements, Global News
                </p>
            </div>

            <div class="card" style="flex-grow: 1;">
                <div class="card-header">BTC/USDT AI PREDICTION TREND</div>
                <canvas id="mainChart"></canvas>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><i class="fas fa-robot"></i> INTELLIGENCE LOGS</div>
            <div class="logs-container" id="terminal-logs">
                <div class="log-entry"><span class="log-time">[INIT]</span> System linking to Blockchain Nodes...</div>
                <div class="log-entry"><span class="log-time">[INIT]</span> Connecting to 18 APIs...</div>
            </div>
            
            <div class="card-header" style="margin-top:10px;"><i class="fas fa-globe"></i> SENTIMENT (NLP)</div>
            <div style="margin-top:10px;">
                <div style="display:flex; justify-content:space-between; font-size:12px; margin-bottom:5px;">
                    <span>Fear</span>
                    <span id="sentiment-text">Neutral</span>
                    <span>Greed</span>
                </div>
                <div style="width:100%; height:8px; background:#2b3139; border-radius:4px; overflow:hidden;">
                    <div id="sentiment-bar" style="width: 50%; height:100%; background:var(--gold); transition: width 0.5s;"></div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // 1. FIREBASE CONFIGURATION (Your Provided Config)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js";
        import { getDatabase, ref, set, push, onValue } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCVn3r1NcjW1OcSxBfWMSFcJ_db-i7p6uc",
            authDomain: "sqlrrr.firebaseapp.com",
            projectId: "sqlrrr",
            storageBucket: "sqlrrr.firebasestorage.app",
            messagingSenderId: "605955318342",
            appId: "1:605955318342:web:7f097ac1b565c5a3b16047",
            measurementId: "G-R1NFCH5C8V"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getDatabase(app);

        // 2. STATE MANAGEMENT (AI BRAIN)
        const state = {
            prices: { BTC: 42000, ETH: 2200, SOL: 95 },
            sentiment: 50, // 0-100
            whaleActivity: 'Low',
            signals: [],
            logCount: 0
        };

        // 3. UI UPDATERS
        const logContainer = document.getElementById('terminal-logs');
        
        function addLog(type, message) {
            const div = document.createElement('div');
            div.className = 'log-entry';
            const time = new Date().toLocaleTimeString('en-US', {hour12: false});
            
            let icon = '';
            if(type === 'WHALE') { icon = 'üêã '; div.classList.add('whale-alert'); }
            if(type === 'NEWS') { icon = 'üì∞ '; div.classList.add('news-alert'); }
            if(type === 'API') { icon = 'üîó '; }

            div.innerHTML = `<span class="log-time">[${time}]</span> ${icon}${message}`;
            logContainer.prepend(div);
            
            // Limit logs
            if(logContainer.children.length > 50) logContainer.lastChild.remove();
        }

        // 4. CHART.JS SETUP
        const ctx = document.getElementById('mainChart').getContext('2d');
        const mainChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'BTC Price',
                    borderColor: '#0ecb81',
                    data: [],
                    borderWidth: 1,
                    pointRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { display: false },
                    y: { grid: { color: '#2b3139' } }
                },
                plugins: { legend: { display: false } }
            }
        });

        // 5. SIMULATE API DATA STREAM 
        // (Note: In production, this data comes from your Python Backend via Firebase)
        
        function simulateDataStream() {
            // Update Prices Randomly
            state.prices.BTC += (Math.random() - 0.5) * 100;
            state.prices.ETH += (Math.random() - 0.5) * 10;
            state.prices.SOL += (Math.random() - 0.5) * 1;
            
            renderMarketList();
            updateChart(state.prices.BTC);
            calculateSignal();
        }

        function renderMarketList() {
            const list = document.getElementById('market-list');
            list.innerHTML = '';
            
            ['BTC', 'ETH', 'SOL'].forEach(coin => {
                const price = state.prices[coin].toFixed(2);
                const isUp = Math.random() > 0.5; // Simulating trend
                const colorClass = isUp ? 'price-up' : 'price-down';
                
                list.innerHTML += `
                    <div class="item">
                        <span style="font-weight:bold;">${coin}USDT</span>
                        <span class="${colorClass}">${price}</span>
                    </div>
                `;
            });
        }

        function updateChart(price) {
            const now = new Date().toLocaleTimeString();
            mainChart.data.labels.push(now);
            mainChart.data.datasets[0].data.push(price);
            
            if(mainChart.data.labels.length > 50) {
                mainChart.data.labels.shift();
                mainChart.data.datasets[0].data.shift();
            }
            mainChart.update();
        }

        // 6. WHALE & NEWS SIMULATION (The "Intelligence" Part)
        setInterval(() => {
            const events = [
                { type: 'WHALE', msg: 'Detected 500 BTC move to Binance (Potential Dump)' },
                { type: 'WHALE', msg: 'Whale accumulated 10,000 SOL via Dex' },
                { type: 'NEWS', msg: 'Reuters: SEC decision delayed on ETF' },
                { type: 'API', msg: 'Scanning Telegram Group: "CryptoInsiders"...' },
                { type: 'API', msg: 'Orderbook Analysis: Buy Wall at $41,500' },
                { type: 'NEWS', msg: 'Elon Musk Tweet detected (Sentiment: Positive)' }
            ];
            const randomEvent = events[Math.floor(Math.random() * events.length)];
            addLog(randomEvent.type, randomEvent.msg);
            
            // Adjust sentiment based on "fake" news for demo
            if(randomEvent.type === 'WHALE') state.sentiment -= 5;
            if(randomEvent.type === 'NEWS') state.sentiment += 2;
            updateSentimentUI();
        }, 4000);

        function updateSentimentUI() {
            // Clamp 0-100
            state.sentiment = Math.max(0, Math.min(100, state.sentiment));
            const bar = document.getElementById('sentiment-bar');
            const text = document.getElementById('sentiment-text');
            
            bar.style.width = state.sentiment + '%';
            if(state.sentiment > 60) {
                bar.style.background = '#0ecb81';
                text.innerHTML = "GREED";
            } else if (state.sentiment < 40) {
                bar.style.background = '#f6465d';
                text.innerHTML = "FEAR";
            } else {
                bar.style.background = '#f0b90b';
                text.innerHTML = "NEUTRAL";
            }
        }

        // 7. FINAL SIGNAL LOGIC (Aggregation)
        function calculateSignal() {
            // Simple Logic: If Sentiment > 60 AND Price is rising -> BUY
            // If Sentiment < 40 AND Whale Dump -> SELL
            
            const elSignal = document.getElementById('final-signal');
            const elConf = document.getElementById('signal-conf');
            
            let signal = "HOLD";
            let color = "#f0b90b"; // Gold
            let confidence = Math.floor(Math.random() * 20) + 60; // 60-80% random

            if (state.sentiment > 65) {
                signal = "STRONG BUY";
                color = "#0ecb81"; // Green
                confidence += 10;
            } else if (state.sentiment < 35) {
                signal = "STRONG SELL";
                color = "#f6465d"; // Red
                confidence += 10;
            }

            elSignal.innerHTML = signal;
            elSignal.style.color = color;
            elConf.innerHTML = `AI Confidence: ${confidence}%`;
            elConf.style.color = color;
            elConf.style.background = color + '22'; // Add transparency
            
            // Optional: Write decision to Firebase
            // push(ref(db, 'ai_decisions'), { time: Date.now(), signal: signal, price: state.prices.BTC });
        }

        // Start Loop
        setInterval(simulateDataStream, 2000);
        addLog("SYSTEM", "AI Engines Initialized.");
        addLog("SYSTEM", "Connected to Firebase Realtime Database.");

    </script>
</body>
  </html>
